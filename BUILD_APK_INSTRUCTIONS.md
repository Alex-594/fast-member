# Инструкция по сборке APK файла через виртуальную машину Kivy

## Шаг 1: Скачивание виртуальной машины

1. Перейдите на страницу: https://github.com/Zen-CODE/kivybits/tree/master/KivyCompleteVM
2. Скачайте готовую виртуальную машину (файл .ova или .zip)
3. Пароль для VM: `kivy`

## Шаг 2: Установка VirtualBox

1. Скачайте VirtualBox с официального сайта: https://www.virtualbox.org/
2. Установите VirtualBox на ваш компьютер
3. Запустите VirtualBox

## Шаг 3: Импорт виртуальной машины

1. В VirtualBox нажмите **"Файл"** → **"Импорт конфигурации"** (или **"File"** → **"Import Appliance"**)
2. Выберите скачанный файл виртуальной машины (.ova)
3. Нажмите **"Импорт"** и дождитесь завершения

## Шаг 4: Запуск виртуальной машины

1. В списке виртуальных машин выберите импортированную VM
2. Нажмите кнопку **"Запустить"** (зеленая стрелка)
3. Дождитесь загрузки Linux (пароль: `kivy`)

## Шаг 5: Копирование проекта в виртуальную машину

### Вариант 1: Через общую папку (рекомендуется)

1. В VirtualBox выберите вашу VM → **"Настройки"** → **"Общие папки"**
2. Нажмите **"Добавить новую общую папку"**
3. Укажите путь к папке с вашим проектом (например: `D:\Documents\!FAST_member`)
4. Отметьте **"Автоподключение"** и **"Создать постоянную папку"**
5. Нажмите **"OK"**
6. В VM откройте терминал и выполните:
   ```bash
   sudo mkdir -p /media/sf_FAST_member
   sudo mount -t vboxsf FAST_member /media/sf_FAST_member
   ```

### Вариант 2: Через Git (если проект на GitHub)

1. В терминале VM выполните:
   ```bash
   cd ~
   mkdir Project
   cd Project
   git clone https://github.com/Alex-594/fast-member.git
   cd fast-member
   ```

### Вариант 3: Через USB-флешку

1. Подключите USB-флешку с проектом
2. В VirtualBox: **"Устройства"** → **"USB"** → выберите вашу флешку
3. Скопируйте файлы проекта в домашнюю папку VM

## Шаг 6: Обновление python-for-android (опционально)

В терминале VM выполните:

```bash
cd /home/kivy/Repos
rm -fr python-for-android/
git clone https://github.com/kivy/python-for-android.git
cd ~
```

## Шаг 7: Переход в папку проекта

```bash
cd ~/Project/fast-member
# или если использовали общую папку:
cd /media/sf_FAST_member
```

## Шаг 8: Сборка APK файла

Выполните команду:

```bash
buildozer android debug
```

**Важно:** 
- Первый раз сборка займет 30-60 минут (скачиваются все зависимости)
- В следующие разы будет быстрее (несколько минут)
- После завершения APK файл будет в папке `bin/`

## Шаг 9: Поиск готового APK файла

```bash
ls -la bin/
```

Вы должны увидеть файл типа `fast-member-1.0.0-debug.apk`

## Шаг 10: Копирование APK на компьютер

### Через общую папку:
APK уже доступен в вашей общей папке на Windows

### Через USB:
1. Подключите USB-флешку
2. Скопируйте файл из `bin/` на флешку

### Через сеть:
Можно использовать SCP или другие инструменты

## Шаг 11: Установка APK на телефон

### Вариант 1: Через USB (рекомендуется)

1. Включите на телефоне **"Режим разработчика"**:
   - Настройки → О телефоне → нажмите 7 раз на "Номер сборки"
2. Включите **"Отладка по USB"** в настройках разработчика
3. Подключите телефон к компьютеру USB-кабелем
4. В VM установите adb (если еще не установлен):
   ```bash
   sudo apt install adb
   ```
5. Проверьте подключение:
   ```bash
   adb devices
   ```
   Должен появиться ваш телефон
6. Установите APK:
   ```bash
   cd bin
   adb install -r fast-member-1.0.0-debug.apk
   ```
7. Дождитесь сообщения **"Success"**

### Вариант 2: Через файловый менеджер

1. Скопируйте APK файл на телефон (через USB, email, облако и т.д.)
2. На телефоне откройте файл
3. Разрешите установку из неизвестных источников (если нужно)
4. Установите приложение

## Просмотр логов приложения (если нужно)

Если приложение падает или работает неправильно:

```bash
adb logcat | grep python
```

## Изменение русского названия приложения (опционально)

1. После первой сборки отредактируйте файл:
   ```bash
   nano .buildozer/android/platform/build/dists/fastmember/templates/strings.tmpl.xml
   ```
2. Найдите тег `<string name="app_name">` и измените название
3. Запустите сборку снова:
   ```bash
   buildozer android debug
   ```

## Решение проблем

### Проблема: VM не запускается
- Убедитесь, что включена виртуализация в BIOS
- Проверьте, что VirtualBox установлен правильно

### Проблема: Не могу скопировать файлы
- Используйте общую папку VirtualBox
- Или используйте Git для клонирования проекта

### Проблема: Сборка падает с ошибкой
- Проверьте, что все файлы проекта на месте
- Убедитесь, что `buildozer.spec` настроен правильно
- Посмотрите логи ошибок в терминале

### Проблема: Телефон не определяется через adb
- Убедитесь, что включена отладка по USB
- Проверьте USB-кабель
- Попробуйте другой USB-порт

## Готово!

Теперь у вас есть APK файл, который можно устанавливать на Android устройства.

